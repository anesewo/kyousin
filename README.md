# 強震モニタ+

## 概要
**強震モニタ+** は、リアルタイムで現在の揺れや緊急地震速報（EEW）の情報を受信・表示するブラウザアプリケーションです。  
データの受信と更新は全自動で行われますが、一部の機能は手動操作が必要な場合があります。  
地図は自由に拡大・縮小・移動が可能です。


## 主な機能

### リアルタイム震度
- NIED（防災科研）が公開している**強震モニタのリアルタイム震度**を自動で表示します。  
- 受信したデータは**自動揺れ検出機能**に使用されます。
- アルゴリズムによる揺れ検出が行われた場合、着未着法を含む走時計算などの反復処理によって震源を推定します（※気象庁の緊急地震速報とは異なります。）。  
  推定には **JMA2001走時表** を使用し、計算結果から現在の **P波・S波到達予報円** を地図上に表示します。緊急地震速報とは異なりP波S波震央は全て同色で揺れの大きさに応じて緑色,黄色,赤色,紫色で表示されます。  
- **揺れ検出**・**自動震源推定**は設定で無効化することができます（計算負荷や誤検知を避けるため）。


### S-netの震度
- 三陸沖・茨城県沖などの海域や日本海溝外側に設置された **S-net** のリアルタイム震度を表示します。  
- 更新は約3分ごとに行われます。揺れ検出や震源推定には使用しません。  
- 海底設置型センサーには固定されていないものもあり、震度が実際より大きく表示されることがあります。


### 緊急地震速報（EEW）
- 気象庁から地震発生後数秒で発表される **緊急地震速報（予報・警報）** を受信し、地図上に震央・到達予報円を表示します。  
- P波は青色、S波は赤色、震央は赤色の✕で表示されます。 
- 緊急地震速報受信後には効果音を鳴らします。
- 緊急地震速報受信後または緊急地震速報情報に大きな変更があった場合は震源地、推定最大震度を読み上げます。 
- UI上では、**震源地・マグニチュード・深さ・推定最大震度** が自動表示されます。  
- 緊急地震速報（警報）が発表された場合は、**発表地域を自動音声で読み上げ**ます。  
  発表地域が10を超える場合、自動的に**地方予報区単位**の読み上げに切り替わります。


## 揺れ検出・震源推定について
リアルタイム震度データから**二点以上の観測点の色の変化を読み取る**ことで、地震を即座に自動検知します。  
これには改良を加えられてきた独自の揺れ検出を使用しています。  

### 揺れ検出
揺れを検出した際、次のような表示を行います。
- 揺れを検出中の観測点は、未検出の観測点と区別できるように0.5秒ごとに通常サイズと2倍サイズを交互に点滅表示します。
- 揺れを検出した範囲を経緯度1度ごとのグリッドに分けて表示します
- 新たに地震を検出または既に検出した地震で震度が上昇した際効果音を鳴らします。
- 新たに地震を検知した際は揺れを検出した観測点が属する地域名を読み上げます。  


### 震源推定
- 理論的には深さも含まれる場合観測点が4点未満の場合は震源が一つに決定されません。4点で決定されるのは理論上の計算ですので大半の事例の場合、5点以上が必要です。
- 着未着法も使用されているため二点程度でも震源が正しく推定される場合があります。
- 「精度の低い可能性のある震源推定も表示する」を無効にしていると5点未満で震源を求めた場合、推定は行いますが表示は行いません。
- ここで求めた震源要素と気象庁からの緊急地震速報の震源要素が酷似している場合、**重複表示を防ぐため自動的に非表示**になります。

> [!NOTE]
> どんな高精度な検出でも誤検知は発生し得ます。
> 震源推定を有効にしている場合、誤検知時に誤推定が行われることもあります。  



## 緊急地震速報について

### 情報元
安定性を高めるため、複数の情報源からEEWを取得しています。

| ソース | 方式 | 遅延 | 特徴・注意点 |
|--------|------|------|---------------|
| [wolfxAPI](https://wolfx.jp/apidoc) | WebSocket + HTTP GET | 少 | 自動的にWS接続とHTTPGETの両方で接続し情報を受信しています。 WS接続では即座に情報を取得することが可能で、HTTPGETはWSのプッシュをタブを開いていなかったなどの原因で見逃した時にEEWの更新まで情報が受信できないことを対策するために使用されています。このAPIは受信遅延は少ないですが稀に通常の地震でもwolfxAPI側で緊急地震速報が発表されない場合があります。 |
| [Yahoo!リアルタイム震度](https://typhoon.yahoo.co.jp/weather/jp/earthquake/kyoshin/) | HTTP GET | 中 | 安定度が高いYahooリアルタイム震度の緊急地震速報データを抽出して表示しています。HTTPGETのみのため遅延は数秒あります。 受信遅延は中程度で、各地の予想震度情報,警報地域がない点や震源が深いと推定された緊急地震速報や使用されている観測点が少ない緊急地震速報が未対応という点や警報か予報かの区別ができない点など一部制限はありますが、安定性の観点から使用しています。 |
| [P2P地震情報（警報のみ）](https://www.p2pquake.net/develop/json_api_v2/)|HTTP GET | 少 | 受信のスピードはこの中で一番早いですが、緊急地震速報（警報）のみです。
一般向けの警報と異なる点は緊急地震速報（予報）についてで説明しています。
| [AXIS（無料登録必須）](https://axis.prioris.jp/manage/channel/) | WebSocket | 少 | 無料のアカウント作成・登録を行いチャンネルEEWの受信を有効にし、ソフト内でユーザートークンを入力することでAXISからのEEW情報が受信できます。 受信遅延は少なく、安定性も高いです。ただしAXISの規約内に「再配信、転載、複製、改変、商用利用は禁止」とあるので必ずライブ配信やTwitter上への投稿等を行う場合ソフト内の「AXISとの接続を切断する」を使用してください。 |


> ※ 上記以外の緊急地震速報サービスも、発見次第順次追加予定です。

### 緊急地震速報（予報）について
このソフトでは高度利用者向けの**緊急地震速報（予報）**または**緊急地震速報（警報）の高度な情報**が表示されます。緊急地震速報（予報）は一般向けに発表される**緊急地震速報（警報）**とは発表基準が異なります。特に以下の点に注意が必要です。  
- 地震発生後、数秒で情報が作成されるため、誤報が発生することがあります。
- 地震検知直後の情報は震源やマグニチュード、予測震度の精度が低いことがあります。
- 通常でも推定震度は1階級程度の誤差があります。
- 深さ150kmより深い地震の場合、予想最大震度は発表されません（※実際の揺れに基づいて発表される場合もあります）。
- 震源の推定が行われなかった場合や100gal超過の場合、
　最初に揺れを検知した観測点を仮定震源として発表される場合があります。
　この時、震源地名や震央の表示は実際の震源を表しません。
また、緊急地震速報（警報）では一般向けに発表される**警報地域**や**震源位置**などの情報に加え、
- 地震の推定される規模
- 震源の深さ
- JMA2001走時表を用いて計算された現在のP波S波到達予報円
- 推定最大震度
が表示されます。



## 配信や動画への使用について
このアプリケーションの表示画面は、**配信や動画等で自由に使用可能**です。  
特別な許可を取る必要はありません。

> [!WARNING]
> ただし、動作の安定性・信頼性は一切保証できません。  
> 利用者の自己責任でご使用ください。

そして上記したように、AXISの規約内に「再配信、転載、複製、改変、商用利用は禁止」とあるので必ずライブ配信やTwitter上への投稿等を行う場合ソフト内の「AXISとの接続を切断する」を使用してください。


## 開発背景
このプロジェクトには前身バージョンが存在します。  
開発開始から約半年を経て、**軽量化**と**機能向上**を目的に本バージョンを新たに作成しました。
